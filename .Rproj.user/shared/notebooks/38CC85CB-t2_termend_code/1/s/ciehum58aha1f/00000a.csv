"0","#------------------------------------------------"
"0","#シェープファイル取得"
"0","#------------------------------------------------"
"0","#チャンクオプションにeval=FALSEを追加"
"0",""
"0",""
"0",""
"0","#今回は東京都と大阪府のシェープファイルをダウンロードしたいのでlistPrefを以下と定義する。"
"0","listPref <- list(13,27)"
"0",""
"0",""
"0","#関数を作成"
"0","#----- START: fDownloadShapefile() -----"
"0","fDownloadShapefile <- function(x){"
"0","  #DLメッセージ"
"0","  print(paste0(""Downloading shapefile of prefecture "", x, "" from e-Stat...""))"
"0","  "
"0","  #ファイル名"
"0","  filename <- paste0(""data_estat/h27ka"", x, "".zip"")"
"0","  "
"0","  #e-Statからシェープファイルのダウンロード"
"0","  urlBase <- ""https://www.e-stat.go.jp/gis/statmap-search/data"""
"0","  urlParam <-"
"0","    paste0(""?dlserveyId=A002005212015&code="","
"0","           x,"
"0","           ""&coordSys=1&format=shape&downloadType=5"")"
"0","  httr::GET(paste0(urlBase, urlParam), write_disk(filename, overwrite = TRUE))"
"0",""
"0","  #ZIPファイルを展開"
"0","  #data_estatフォルダのZIPファイルを，同一フォルダ内に展開する"
"0","  unzip(filename, exdir = ""data_estat"", overwrite = TRUE)"
"0","}"
"0","#----- END: fDownloadShapefile() -----"
"0",""
"0","#次のループを実行するまでの待機時間"
"0","sleepSecond <- 5"
"0",""
"0","#For文de"
"0","for (i in listPref) {"
"0","  "
"0","  #関数を実行する"
"0","  fDownloadShapefile(i)  "
"0",""
"0","  #次のループまで待機"
"0","  Sys.sleep(sleepSecond)"
"0","}"
"1","[1]"
"1"," ""Downloading shapefile of prefecture 13 from e-Stat..."""
"1","
"
"1","[1]"
"1"," ""Downloading shapefile of prefecture 27 from e-Stat..."""
"1","
"
"0","#ファイルがあるか確認"
"0","dir(""data_estat"")"
"1"," [1]"
"1"," ""h27ka13.dbf"""
"1"," ""h27ka13.prj"""
"1"," ""h27ka13.shp"""
"1"," ""h27ka13.shx"""
"1"," ""h27ka13.zip"""
"1"," ""h27ka27.dbf"""
"1","
"
"1"," [7]"
"1"," ""h27ka27.prj"""
"1"," ""h27ka27.shp"""
"1"," ""h27ka27.shx"""
"1"," ""h27ka27.zip"""
"1","
"
